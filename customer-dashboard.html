<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Ruf Bac Tour Services - Customer Dashboard - Manage your bookings and explore tours">
    <title>Ruf Bac Tour Services | My Dashboard</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
    
    <!-- Google Fonts - Inter (bold, readable) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- Custom CSS -->
    <link href="assets/css/style.css" rel="stylesheet">
</head>
<body>
    <!-- Animated Background -->
    <div class="bg-gradient-animated"></div>
    <div class="bg-shapes">
        <div class="shape shape-1"></div>
        <div class="shape shape-2"></div>
        <div class="shape shape-3"></div>
    </div>

    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg glass-nav fixed-top">
        <div class="container-fluid px-4">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <div class="brand-icon me-2">
                    <img src="assets/images/logo.jpg" alt="Ruf Bac Tour Services" class="brand-logo-img">
                </div>
                <div>
                    <span class="brand-text">Ruf Bac</span>
                    <small class="brand-subtitle d-none d-sm-block">Tour Services</small>
                </div>
            </a>
            
            <div class="d-flex align-items-center gap-3">
                <!-- Mobile Menu Toggle -->
                <button class="btn btn-glass d-lg-none" id="mobileMenuToggle" type="button" aria-label="Toggle menu">
                    <i class="bi bi-list"></i>
                </button>
                <a href="landing.html" class="btn btn-glass d-none d-md-inline-flex" title="Home">
                    <i class="bi bi-house me-1"></i>
                    <span>Home</span>
                </a>
                <div class="nav-time d-none d-md-block">
                    <i class="bi bi-clock me-1"></i>
                    <span id="currentTime">--:--</span>
                </div>
                <div class="dropdown">
                    <button class="btn btn-glass dropdown-toggle" type="button" id="userMenuBtn" data-bs-toggle="dropdown">
                        <i class="bi bi-person-circle me-1"></i>
                        <span id="userEmail">Loading...</span>
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li><a class="dropdown-item" href="#" id="viewProfileBtn"><i class="bi bi-person me-2"></i>View Profile</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="#" id="logoutBtn"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
                    </ul>
                </div>
                <button class="btn btn-glass" id="refreshBtn" title="Refresh Data">
                    <i class="bi bi-arrow-clockwise"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- Sidebar Navigation -->
    <aside class="sidebar sidebar-expanded" id="sidebar">
        <!-- Sidebar Header -->
        <div class="sidebar-header">
            <div class="sidebar-brand">
                <div class="brand-icon">
                    <img src="assets/images/logo.jpg" alt="Ruf Bac Tour Services" class="brand-logo-img">
                </div>
                <div class="sidebar-brand-text">
                    <span class="brand-text">Ruf Bac</span>
                    <small class="brand-subtitle">Tour Services</small>
                </div>
            </div>
            <button class="sidebar-toggle d-none d-lg-flex" id="sidebarToggle" type="button" aria-label="Toggle sidebar">
                <i class="bi bi-chevron-left"></i>
            </button>
        </div>

        <!-- Navigation Menu -->
        <nav class="sidebar-nav">
            <ul class="sidebar-menu">
                <li class="sidebar-menu-item">
                    <a href="customer-dashboard.html" class="sidebar-menu-link active" data-page="dashboard" data-tooltip="Dashboard">
                        <i class="bi bi-speedometer2"></i>
                        <span class="sidebar-menu-text">Dashboard</span>
                    </a>
                </li>
                <li class="sidebar-menu-item">
                    <a href="#" class="sidebar-menu-link" id="sidebarBookingsLink" data-page="bookings" data-tooltip="My Bookings">
                        <i class="bi bi-calendar-check"></i>
                        <span class="sidebar-menu-text">My Bookings</span>
                    </a>
                </li>
                <li class="sidebar-menu-item">
                    <a href="customer-browse.html" class="sidebar-menu-link" data-page="browse" data-tooltip="Browse Tours">
                        <i class="bi bi-search"></i>
                        <span class="sidebar-menu-text">Browse Tours</span>
                    </a>
                </li>
                <li class="sidebar-menu-item">
                    <a href="#" class="sidebar-menu-link" id="sidebarProfileLink" data-page="profile" data-tooltip="My Profile">
                        <i class="bi bi-person"></i>
                        <span class="sidebar-menu-text">My Profile</span>
                    </a>
                </li>
            </ul>
        </nav>

        <!-- Sidebar Footer -->
        <div class="sidebar-footer">
            <div class="sidebar-user">
                <i class="bi bi-person-circle"></i>
                <div class="sidebar-user-info">
                    <span class="sidebar-user-name" id="sidebarUserName">Loading...</span>
                    <small class="sidebar-user-email" id="sidebarUserEmail">Loading...</small>
                </div>
            </div>
            <button class="sidebar-logout-btn" id="sidebarLogoutBtn" type="button" title="Logout">
                <i class="bi bi-box-arrow-right"></i>
            </button>
        </div>
    </aside>

    <!-- Sidebar Backdrop (Mobile) -->
    <div class="sidebar-backdrop" id="sidebarBackdrop"></div>

    <!-- Main Content -->
    <main class="main-content main-content-with-sidebar">
        <div class="container-fluid px-4">
            
            <!-- Dashboard Header -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="d-flex flex-wrap justify-content-between align-items-center gap-3">
                        <div>
                            <h1 class="page-title mb-1">My Dashboard</h1>
                            <p class="page-subtitle mb-0">
                                <span id="greetingText">Welcome back</span> — 
                                <span id="todayDate">Loading...</span>
                            </p>
                        </div>
                        <div class="d-flex gap-2 flex-wrap">
                            <button class="btn btn-primary-gradient btn-lg" id="newBookingBtn">
                                <i class="bi bi-calendar-plus me-2"></i>New Booking
                            </button>
                            <button class="btn btn-glass btn-lg" id="viewProfileBtnHeader">
                                <i class="bi bi-person me-2"></i>My Profile
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Stats Cards -->
            <div class="row g-4 mb-4" id="statsContainer">
                <!-- Total Bookings -->
                <div class="col-6 col-lg-3">
                    <div class="glass-card stat-card">
                        <div class="stat-icon stat-icon-primary">
                            <i class="bi bi-calendar-check"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="statTotalBookings">--</span>
                            <span class="stat-label">Total Bookings</span>
                        </div>
                    </div>
                </div>
                
                <!-- Upcoming Bookings -->
                <div class="col-6 col-lg-3">
                    <div class="glass-card stat-card">
                        <div class="stat-icon stat-icon-success">
                            <i class="bi bi-calendar-event"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="statUpcomingBookings">--</span>
                            <span class="stat-label">Upcoming</span>
                        </div>
                    </div>
                </div>
                
                <!-- Total Spent -->
                <div class="col-6 col-lg-3">
                    <div class="glass-card stat-card">
                        <div class="stat-icon stat-icon-accent">
                            <i class="bi bi-currency-dollar"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="statTotalSpent">--</span>
                            <span class="stat-label">Total Spent</span>
                        </div>
                    </div>
                </div>
                
                <!-- Pending Payments -->
                <div class="col-6 col-lg-3">
                    <div class="glass-card stat-card">
                        <div class="stat-icon stat-icon-warning">
                            <i class="bi bi-hourglass-split"></i>
                        </div>
                        <div class="stat-content">
                            <span class="stat-value" id="statPendingPayments">--</span>
                            <span class="stat-label">Pending Payments</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Main Content Row -->
            <div class="row g-4">
                <!-- My Bookings Section -->
                <div class="col-12 col-xl-8">
                    <div class="glass-card">
                        <div class="card-header-custom">
                            <h2 class="card-title-custom">
                                <i class="bi bi-list-ul me-2"></i>My Bookings
                            </h2>
                            <div class="d-flex gap-2 flex-wrap">
                                <!-- Search -->
                                <div class="search-box">
                                    <i class="bi bi-search"></i>
                                    <input type="text" class="form-control form-control-glass" 
                                           id="searchInput" placeholder="Search by destination...">
                                </div>
                                <!-- Filter -->
                                <select class="form-select form-select-glass" id="statusFilter">
                                    <option value="">All Bookings</option>
                                    <option value="upcoming">Upcoming</option>
                                    <option value="past">Past</option>
                                    <option value="cancelled">Cancelled</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="table-responsive">
                            <table class="table table-glass" id="bookingsTable">
                                <thead>
                                    <tr>
                                        <th>Tour</th>
                                        <th>Booking Date</th>
                                        <th>Travel Dates</th>
                                        <th>Guests</th>
                                        <th>Status</th>
                                        <th>Payment</th>
                                        <th>Amount</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="bookingsTableBody">
                                    <!-- Dynamic content -->
                                </tbody>
                            </table>
                        </div>
                        
                        <!-- Loading State -->
                        <div class="loading-overlay" id="tableLoading">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                        
                        <!-- Empty State -->
                        <div class="empty-state d-none" id="emptyState">
                            <i class="bi bi-inbox"></i>
                            <h3>No bookings found</h3>
                            <p>Start by creating your first booking!</p>
                        </div>
                        
                        <!-- Pagination -->
                        <div class="pagination-wrapper d-none" id="paginationContainer">
                            <div class="pagination-info" id="paginationInfo">
                                Showing 1-10 of 20 bookings
                            </div>
                            <div class="pagination-controls">
                                <button class="pagination-btn" id="prevPageBtn" disabled>
                                    <i class="bi bi-chevron-left"></i>
                                </button>
                                <div class="page-numbers" id="pageNumbers">
                                    <!-- Dynamic page numbers -->
                                </div>
                                <button class="pagination-btn" id="nextPageBtn">
                                    <i class="bi bi-chevron-right"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Sidebar - Available Tours -->
                <div class="col-12 col-xl-4">
                    <div class="glass-card">
                        <div class="card-header-custom">
                            <h2 class="card-title-custom">
                                <i class="bi bi-geo-alt me-2"></i>Available Tours
                            </h2>
                        </div>
                        <div class="tour-grid" id="availableTours">
                            <!-- Dynamic content -->
                        </div>
                        <div class="text-center mt-3">
                            <a href="customer-browse.html" class="btn btn-glass">
                                <i class="bi bi-search me-2"></i>Browse All Tours
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Booking Modal -->
    <div class="modal fade" id="bookingModal" tabindex="-1" aria-labelledby="bookingModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content glass-modal">
                <div class="modal-header">
                    <h5 class="modal-title" id="bookingModalLabel">
                        <i class="bi bi-calendar-plus me-2"></i>New Booking
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="bookingForm">
                        <input type="hidden" id="bookingId">
                        
                        <div class="row g-3">
                            <!-- Tour Selection -->
                            <div class="col-md-12">
                                <label for="tourSelect" class="form-label">Select Tour *</label>
                                <select class="form-select form-select-glass" id="tourSelect" required>
                                    <option value="">Select a tour...</option>
                                </select>
                                <div class="form-text" id="tourInfo"></div>
                            </div>
                            
                            <!-- Booking Date -->
                            <div class="col-md-6">
                                <label for="bookingDate" class="form-label">Booking Date *</label>
                                <input type="date" class="form-control form-control-glass" id="bookingDate" required>
                            </div>
                            
                            <!-- Number of Guests -->
                            <div class="col-md-6">
                                <label for="numGuests" class="form-label">Number of Guests *</label>
                                <input type="number" class="form-control form-control-glass" id="numGuests" 
                                       min="1" max="20" value="1" required>
                            </div>
                            
                            <!-- Total Amount (Auto-calculated) -->
                            <div class="col-md-12">
                                <div class="alert alert-info">
                                    <strong>Total Amount: $<span id="totalAmountDisplay">0.00</span></strong>
                                    <small class="d-block mt-1">Calculated as: Tour Price × Number of Guests</small>
                                </div>
                            </div>
                            
                            <!-- Notes -->
                            <div class="col-12">
                                <label for="bookingNotes" class="form-label">Notes (Optional)</label>
                                <textarea class="form-control form-control-glass" id="bookingNotes" 
                                          rows="3" placeholder="Any special requests or notes..."></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-glass" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary-gradient" id="saveBookingBtn">
                        <i class="bi bi-check-lg me-2"></i>Create Booking
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Booking Details Modal -->
    <div class="modal fade" id="bookingDetailsModal" tabindex="-1" aria-labelledby="bookingDetailsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content glass-modal">
                <div class="modal-header">
                    <h5 class="modal-title" id="bookingDetailsModalLabel">
                        <i class="bi bi-info-circle me-2"></i>Booking Details
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="bookingDetailsBody">
                    <!-- Dynamic content -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-glass" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-danger d-none" id="cancelBookingBtn">
                        <i class="bi bi-x-lg me-2"></i>Cancel Booking
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Cancel Booking Confirmation Modal -->
    <div class="modal fade" id="cancelBookingModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content glass-modal">
                <div class="modal-header">
                    <h5 class="modal-title text-danger" id="cancelBookingModalTitle">
                        <i class="bi bi-exclamation-triangle me-2"></i>Cancel Booking
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="cancelBookingModalBody">
                    <p>Are you sure you want to cancel this booking?</p>
                    <p class="text-muted small">This action cannot be undone. Your booking will be marked as cancelled.</p>
                    <input type="hidden" id="cancelBookingId">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-glass" data-bs-dismiss="modal">No, Keep It</button>
                    <button type="button" class="btn btn-danger" id="confirmCancelBtn">
                        <i class="bi bi-x-lg me-2"></i>Yes, Cancel Booking
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Profile Modal -->
    <div class="modal fade" id="profileModal" tabindex="-1" aria-labelledby="profileModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content glass-modal">
                <div class="modal-header">
                    <h5 class="modal-title" id="profileModalLabel">
                        <i class="bi bi-person me-2"></i>My Profile
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="profileForm">
                        <input type="hidden" id="customerId">
                        <div class="row g-3">
                            <!-- First Name -->
                            <div class="col-md-6">
                                <label for="customerFirstName" class="form-label">First Name *</label>
                                <input type="text" class="form-control form-control-glass" id="customerFirstName" 
                                       placeholder="John" required>
                            </div>
                            
                            <!-- Last Name -->
                            <div class="col-md-6">
                                <label for="customerLastName" class="form-label">Last Name *</label>
                                <input type="text" class="form-control form-control-glass" id="customerLastName" 
                                       placeholder="Doe" required>
                            </div>
                            
                            <!-- Email -->
                            <div class="col-md-6">
                                <label for="customerEmail" class="form-label">Email *</label>
                                <input type="email" class="form-control form-control-glass" id="customerEmail" 
                                       placeholder="john.doe@email.com" required>
                            </div>
                            
                            <!-- Phone -->
                            <div class="col-md-6">
                                <label for="customerPhone" class="form-label">Phone</label>
                                <input type="tel" class="form-control form-control-glass" id="customerPhone" 
                                       placeholder="+1-555-0100">
                            </div>
                            
                            <!-- Address -->
                            <div class="col-12">
                                <label for="customerAddress" class="form-label">Address</label>
                                <textarea class="form-control form-control-glass" id="customerAddress" 
                                          rows="2" placeholder="Street address, City, State, ZIP"></textarea>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-glass" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary-gradient" id="saveProfileBtn">
                        <i class="bi bi-check-lg me-2"></i>Update Profile
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container position-fixed bottom-0 end-0 p-3" id="toastContainer"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JS -->
    <script src="assets/js/api.js"></script>
    <script src="assets/js/customer-dashboard.js"></script>
</body>
</html>

